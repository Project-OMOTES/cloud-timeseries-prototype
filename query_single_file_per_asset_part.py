asset_ids = [
'0072f6a9-f1ee-4df4-8784-99502509fb44',
'01fe3dee-379a-4406-8519-e0c2352067f4',
'03095e79-dba3-4309-a580-e9a3ac10b12f',
'034f3ca1-ed79-46b8-a5d2-e8cebe5358ca',
'03580145-5d8a-4616-a325-02aa028b17f7',
'037a6610-8eaf-4104-9b51-2fc57b690baf',
'04726b2a-985f-4ae7-8645-0776168dc148',
'04802f7f-398f-491e-b467-497a8b585c23',
'05e00022-02b0-4407-b2d8-cf9026aec440',
'05f1b916-41bf-451b-b84f-c0eb30da84cd',
'096162a0-7826-483e-b166-1a2b8b269098',
'0a9842fc-ab7f-4daf-960a-30bbb13bb06d',
'0c83dabf-5def-4b74-a6e1-f3d1dfd89fee',
'0ebe7571-9956-4ba9-9756-78047e37278b',
'0f3349e2-2e62-4c6a-a4fa-48e27823f6dc',
'0f8d1ac6-f529-4845-ab1d-e2587456db3d',
'0ff7309d-2539-4f1b-a9eb-7ac50566630f',
'0ffc209e-e41d-4429-abea-fcb6b068dff6',
'10f49bce-f7f4-47cb-9e95-68dc95bd6ee8',
'112f342d-1959-45f0-a70d-3210f8bb9fba',
'1301d46d-f816-4bef-b35d-fe4b1e163a4d',
'141f45c9-c040-41af-872b-602a085f1b76',
'14fc14b2-68ef-4a50-a232-2adc295de76b',
'15132dea-555d-4c4d-a436-da658e3a05e8',
'15f9ad4b-c225-43dc-8ed1-5891d438cbea',
'161c5d2c-c0cf-4d23-bbca-34c33382f0e0',
'16797f47-da39-425c-9516-b5700e03172e',
'173cf6e6-4544-49cf-afa5-c3d70c7ca2fe',
'1796aac3-7c55-4758-938e-34411789bc90',
'183f3031-edec-4213-99e6-485d42f8d803',
'1b632ed0-eb12-42cc-931d-1037d02bee60',
'1c5d5add-c090-4169-b645-0f8355d63e5b',
'1c9bebc5-8944-4693-81df-701b6a08bc56',
'1d6e9814-f3c4-484d-a74c-166271e03978',
'1eb5555b-2232-4290-9b75-7db481334d7a',
'1faa070f-c120-4b3b-a9c5-cd824aefa272',
'20fb616e-814f-4543-be49-c0465eab4502',
'2115e8ba-2c87-4682-8998-e1fb77ee23a1',
'21860edc-fca3-4611-9dd8-30847a0d9303',
'223827f1-24df-4f4c-bcae-bae47dae689a',
'229638a5-ae38-4163-881e-436148ccce66',
'22b3b59e-83a2-4e33-a936-dfa941e47b1a',
'22e953cb-265d-4780-b8dc-90850b6c9371',
'22f18fe4-8fcf-4973-8f0b-faacbda8eb3c',
'281cc7d8-e7e7-4d18-9e23-0dcda9117cd0',
'294949c1-0c80-408e-bbe9-3dc576c67dc1',
'2a14cac1-5423-46cd-b9d5-876864b7f2c9',
'2a95b978-47e7-4d6e-838f-0de7da569fd5',
'2b424283-ecb1-4c0d-8a77-f6e5c899104f',
'2c064ed7-ee3b-4506-9e36-6377853a0f22',
'2f06723d-9ac4-44f6-a84c-8f3616305158',
'2f07646d-c482-4101-a701-00c505c095bd',
'300d7a63-aaaa-4240-825f-16154f4c3970',
'3088aba4-ddff-4ff1-9cdc-574acacb7c66',
'30e107f7-4f8b-4b85-b295-b89baa316739',
'319f4d19-26d5-4312-953b-2924a8fb8ca9',
'34a932a6-549b-4df1-8808-067ee1c2e119',
'34fbd087-f869-48e6-bca0-c945ecd06b07',
'35436b05-450a-4e8b-8b0c-ef6ae8793d72',
'3637b12b-07ce-4c20-a746-18690b22377d',
'36be8c1b-8334-4e89-a690-8da7b3f2f58c',
'37efc8e0-370f-4c79-96b2-87debe9a88d9',
'382128ae-cdb8-4f5c-88cc-f0eb4f506bdf',
'38b7d381-9375-4820-99d8-7deffbd29053',
'38fdb513-19a3-4c95-a720-479f7a41ae70',
'3ab93039-1f8c-4788-a25b-ee15ad2085ca',
'3af17951-6d9b-4c68-9260-f89e006c01d9',
'3ba41ac3-abd0-4142-bee1-f999fb5d52a9',
'3c6aa4a9-3281-4521-b102-2f5992759802',
'3c84c106-f456-4fbe-be8d-75c8bb780680',
'3cebf3ef-fa29-4f91-8aa8-fb01daa38227',
'3de6f96a-cdb7-474d-8f76-f6f13e1b53e2',
'3ff472c5-47b5-4243-950c-9f6d3c4c372c',
'40edac8b-632d-4c14-ab40-58763071914a',
'42dbc6fb-39be-423c-856d-ffbdb6fd85b6',
'4316132c-b6bb-40ed-9b36-7fcc26415f98',
'45b757b4-85fc-4608-87ff-9350464f3f78',
'45e5d83a-b198-46ae-af81-257cdfefd7f5',
'46743f0e-baf3-4a31-b9ee-2ab316717794',
'4875ac42-e787-4069-ab71-9dca82adacf2',
'49abe6c2-04b3-43de-970e-d0fd01089d7a',
'4ad3c6d5-4dfe-4e9c-8659-7188adaf7002',
'50d70445-1545-490f-9911-8251c045c579',
'5164685f-5c07-4406-9741-e51b193ea68b',
'520ef374-b7cf-4a70-ab40-c9c2b645ec47',
'52cc454a-390b-43ae-a67f-1bd5ec280c0d',
'5483e35c-9445-4df9-af9e-1030a863d621',
'54afb068-3056-446c-965a-8d0df9f5627f',
'55ab067f-679f-432c-a5f9-dcc601197d39',
'55e77ccd-c14c-4e1a-8ccf-182986298c20',
'56a0553f-69df-450e-ae5f-b6fb5142e752',
'5869d251-d4e0-4dfe-8489-d5a9283337b5',
'5873ca8d-c6a1-4346-a3aa-520528ca5bc9',
'599bbe18-f746-49cd-ade6-7c49b58e0b21',
'5a9b6cc4-aaae-4977-a220-d0824cc8a46d',
'5b1b1d56-db4d-40d1-8c6f-7614fe3724b3',
'5d2e83cb-0869-46a1-9420-96fec052b5a1',
'5e928198-5fe9-4017-8773-977c9493b5b6',
'5fc24a75-2bc6-4d14-b9a6-3acc34980a13',
'6165801d-6877-46af-af44-9f50ed06b10b',
'619835d4-307f-40c4-8319-950c1537daba',
'61b7faf3-e2ef-4562-ab32-78edd6b461ff',
'633b55d7-e00b-4f30-8f3f-028c95429618',
'639f662f-61c5-4f14-b69d-832ee38159f5',
'664ea8bb-0ca7-412f-858a-f5ed78ae120e',
'670017a8-6cf8-4a34-84e5-dfb5065cd586',
'67081912-c2ae-4782-be6a-c53c7db63544',
'67614d54-682b-45bc-bab7-486eb07c3bd7',
'680cb99b-4d0c-4482-a165-0dac0eb70d2b',
'695f2050-cdb6-4582-bebf-cbe63912f2dc',
'6b5b511a-8137-4127-9eb4-6b370c980aec',
'6c81af18-6643-483a-872e-52543e4235c9',
'6d1ee846-03d7-404f-a495-b5097934eedd',
'6d50a945-7bb5-4211-983c-cea0c1350f8a',
'6d645457-5afe-43d2-abe9-32f83c1a9508',
'6e3fc504-5a58-4933-896b-4429c9f0a7ba',
'6f9fb918-56ec-4568-913b-94e8e79e7234',
'71aee447-dc9b-4e77-a3f8-62d51a7c0003',
'72f4ca2c-981a-45a0-85f9-00ecaef9a04d',
'7359af99-d27d-4a97-b9fd-996a19a96902',
'738bf4c8-25df-407c-ae9a-e61ae75e43c7',
'739aea80-653f-473d-a2cc-e1d06af8750f',
'74a3532d-91d1-449c-aac1-3a0e90cff7f6',
'74b8dbf4-c1c6-4c92-abb4-9209ea20a461',
'757988fe-e9c6-463a-8e25-cc08e28cd510',
'7706e14c-f530-4f4d-a783-d8f3be3b653c',
'774ae793-ed51-42e5-91ac-8aa1c4ae398f',
'7821b2e1-9bd9-4061-a98e-cff6fad3adcd',
'7c11dc5a-6507-41d4-98b8-7574b9a67157',
'7c99e14d-be2f-4b82-8de4-4969b350db81',
'7d0b6fd9-0491-426b-b7d9-d938e42debba',
'7d5d100b-ae6e-4856-937a-a8edba6a4df7',
'7ebe0f0f-793d-4d3d-a025-86874e38b683',
'7edc5a5f-5894-4c84-afb0-dc50c461ca90',
'7f5f15dc-7cb9-48b1-a259-47cefe321a6f',
'7f8cbb47-0153-4a4c-8309-772264d9a6b2',
'7f914d1d-8c85-4fd8-83cb-42862b460526',
'804bbb55-a20c-4b06-8d59-24f42ee2a844',
'82849578-4aea-4f96-85a5-4e751b8608f3',
'82c1a105-3dde-4d54-8205-d9462393fd74',
'82e9d9f4-d3e1-42bd-92bc-a349da269ac5',
'846f154c-d546-4a9a-bbc6-b073bf259909',
'8590fbb1-f722-40ea-abdf-a136b3f18423',
'86d6859f-8115-4620-aac1-6ab90c335245',
'890d3fe2-8c0b-40c8-9472-46cbd7354caa',
'8aea3baa-454c-4879-90ed-e4a69ad7e47e',
'8c366bd0-d4eb-40d6-b047-9944324d2cf2',
'8c9f914a-d765-4904-ac60-f93763702b05',
'8e70ceac-cd8a-4ad6-802c-0a210461b69d',
'8f239165-a14c-42c9-b09d-3cfde306ce0b',
'8f4a58ed-226d-45e6-aa5f-be6fd7353b5b',
'8fd73917-a270-4714-bd7a-6aa405c44880',
'9109cdc1-7b30-4992-bc9c-953c85e60442',
'912c7ee0-7687-4a22-a329-7a8bf73b3181',
'927213ea-bdf1-48f1-8098-548e599f555b',
'928ca3c0-e76d-4b4a-af9b-396fc2dfa7a7',
'946a3fb6-b716-4159-912d-c3bf478776fc',
'954d7320-84af-4c92-b861-ab73e70fd9a3',
'97d970c7-5362-412e-b525-8a7d36ee3eb0',
'98d2e116-98e2-4d53-9245-791e8da15704',
'9a4bcec4-1795-40aa-856d-b2a695ece957',
'9b7b4a79-63ad-4e67-93f2-d5a982832031',
'9c770ecb-3f17-4d1e-8665-902e348f30cc',
'9cae434c-6580-49ba-935a-6ac8b665a825',
'9d105b7d-caea-40eb-b9f7-f945a3ff339d',
'9d5355d7-bf0a-4ba7-9e4b-1036e35c3d44',
'9e97c9fe-2af5-479a-bb2f-bd8b86bcaa11',
'9eb788cd-4e8b-445c-8ecc-4756014d90b3',
'9f05aa4f-d161-4d79-8010-7b7bccf7caaf',
'a0c8fd3d-67ca-41a0-baab-628d7fd88c01',
'a298c7ba-6355-4c52-86b6-7672df411c14',
'a4608e33-e8f2-448e-be32-2bc9d56ebeed',
'a6c14b1c-6129-4067-a1a5-e6721d37a368',
'a7113049-f80b-4aeb-8919-573dbcf230a8',
'a8084ffc-7e0d-4811-95b1-d46877e7497a',
'a8eb6ea0-5e30-41ac-872c-a7089455ef51',
'a9ab102f-8f0a-4b6e-8d23-5771859be120',
'aada0654-d337-4214-b362-14234d03f05e',
'ac8cd7c7-8186-46b3-9852-65e5d89409d4',
'acaeb758-5de6-48a1-9c84-adbb69f9fc01',
'aed66a91-2f04-4811-89db-b927ace5649b',
'b1770976-f702-4593-a2cd-beb2e75f9202',
'b2f40060-eca2-4f17-9ea5-68e20abf8d07',
'b4be6a13-b22a-41f4-94b5-8330ae013a75',
'b5c2ac31-f903-4e8a-99b5-b8ceefbd98f4',
'b6639d1e-e19a-4063-8a07-80c395acedcc',
'b67fb1dc-526f-432d-bea8-ab79c5b30210',
'b6bfa952-6f68-45d7-9f84-51238b558a3a',
'b9988a49-3303-4d41-8a3e-1e1c6333b234',
'b9b3c29d-4931-4b23-af19-8ef614e7d576',
'b9ecedd5-321c-44a5-b9eb-4756c1a94cba',
'bacc229f-e4e1-4229-b635-7ae2647f8f8a',
'bbf0c360-a55e-4594-9673-9ad76a187170',
'bc186969-ee31-44f4-a3fe-e6112905df09',
'bc4b711c-15f7-4787-ad05-3dcb80b8031e',
'bd7d4c9f-65c5-4237-a91a-6b9149988d11',
'c077a86c-4b3b-4074-a0b3-7aacc369a6f7',
'c1b1825b-b436-4dbe-8fa2-49a38fa8c1a9',
'c2327af7-131d-4f5c-84a2-0365eecde28a',
'c3cb1850-5e08-48c4-bd39-e94c4f0fbfa2',
'c4347dfb-17ae-4835-8628-9a261815129b',
'c4a465ab-b0c1-49ee-b8cf-c595cc1f6c4a',
'c4bd6138-8d67-4d46-b3f9-de6f0f7db94c',
'c4dcbee5-1adc-48b6-b37f-03f2eef2f159',
'c6ec615c-3eb5-4cef-9ac4-33026861e18a',
'c79cd108-ba69-4c21-9831-826b934432b2',
'ca6ec436-98ca-4c82-96ca-d22b46d775d1',
'cae97d97-970e-4063-a42c-824bcd60f9f5',
'caf8afb2-0962-48ba-9bc1-c16285dcf42c',
'ccc32fd3-3b92-49fc-b163-3bbe41c341df',
'ccc795b1-d899-403a-8016-c6e06ef7cdb3',
'cdb0ea73-f561-4cda-ba1d-d52fcc093159',
'cdfb5e71-755d-42b9-80a9-2fe71fa2132c',
'd164f428-43b4-4d01-ad7b-33c602a89d64',
'd2ded9af-30be-452f-9fbe-025c01d444fa',
'd3ccf0af-edfa-4837-a9fe-18815e2f6227',
'd5735b6f-6df7-4f3c-baf6-272efb8434a4',
'd5fa38ad-1a75-4e53-b88f-bf53c9a46f8e',
'd68f59e3-7f23-42bf-81e4-ff79becee609',
'd726c481-4aea-44c2-94fc-3ec72304d851',
'd7a355c9-b482-4a7b-887a-3294eddd4d8e',
'da678c46-f054-4ee4-a4de-556ee5bcd8c4',
'dca683b8-72e0-42d0-b73f-349e6a1c363c',
'dce36f79-8c2f-40d7-a057-94bcf6473020',
'df791f92-6de5-48b9-aa7b-f6ef54c267b3',
'e20d968f-df7e-4a13-816b-404f88c74de7',
'e3062068-8594-46bf-b6e3-4810ce98368f',
'e561cbf9-9833-479c-aecc-4b4e6c13a438',
'e57a9e22-5d59-4f44-b57d-ad9ea0ae1cb4',
'e5ee8e60-de1c-4bfd-a02a-9e14b76e5277',
'e6f6ea2b-3863-4c92-8874-617a64c62c85',
'e793e723-9fed-49fb-acf0-6002a2fbeee6',
'e805235f-09a0-4949-9a54-ce8c18061440',
'ea5c7149-6108-4846-9705-dcc006ee550f',
'eb28ae31-a89d-42ea-9c26-1cf03fefe8bb',
'eb44956a-b566-42eb-b3d2-7b25c68f3213',
'ee610391-80fe-4b30-b985-06037b5bf56b',
'f252e6c4-4bc1-457c-91bf-fa0b8d5b20bd',
'f674e6bb-4c62-4d3c-9163-0a3bb6900485',
'f76bc350-35d0-4cf4-a006-3d0092bde6f3',
'f7d47d29-d6f8-498d-b45f-85af220dea27',
'f8b7d520-e7fb-4908-9866-5ed5f6a2f1fb',
'f8f8abe3-36c3-42db-b60a-96b66be5c86c',
'f9b95550-1e82-4315-9b05-167301c7eb66',
'facb6aa3-d210-447b-b9dd-0e97b93a6087',
'fbacc6e4-25bf-4cbc-8a65-c5b2e758661f',
'fc6b1d9e-37e2-452e-9103-345ae2397970',
'fdbaa518-d1bd-40c0-be6b-e6492a9276b0',
'fe25f3ce-ec4a-40dd-b4a4-1d6e6c48aa8a',
'fe5cd093-ba48-490d-910f-fa8fc6ea1bc6',
]

import time
import pandas
import duckdb
import pytz
start_init = time.time()
con = duckdb.connect(":memory:")
con.sql("""
CREATE SECRET secret1 (
    TYPE S3,
    PROVIDER CREDENTIAL_CHAIN,
    CHAIN 'env;config',
    REGION 'XX-XXXX-X       ',
    ENDPOINT 'localhost:9000',
    URL_STYLE 'path',
    USE_SSL false,
    KEY_ID 'test',
    SECRET '12345678'
);
""")

start = time.time()
for asset_id in asset_ids:
    con.sql(f'SELECT HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/62a079a5-5aff-45cd-930c-eab253700375/*/*.parquet\']) WHERE asset_id=\'{asset_id}\';').df()
end = time.time()

diff = end - start
per_q = diff / len(asset_ids)
print(f'DuckDB took {diff} seconds which means {per_q} second per q when accessing each profile individually')



start = time.time()
con.sql(f'SELECT time, asset_id, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/62a079a5-5aff-45cd-930c-eab253700375/*/*.parquet\']) WHERE asset_id IN ({','.join(f"'{asset_id}'" for asset_id in asset_ids)});').df()
end = time.time()

diff = end - start
per_q = diff / len(asset_ids)
print(f'DuckDB Took {diff} seconds when accessing the profile for all assets at once')


from pyarrow import fs
import pyarrow.parquet as pq

s3 = fs.S3FileSystem(access_key='test',
                     secret_key='12345678',
                     scheme='http',
                     endpoint_override='localhost:9000')

start_arrow = time.time()
print(pq.read_table(f"test-parquet/62a079a5-5aff-45cd-930c-eab253700375/", filesystem=s3, columns=['HeatIn_Q1', 'time', 'asset_id']).to_pandas())
end_arrow = time.time()

diff = end_arrow - start_arrow
per_q = diff / len(asset_ids)
print(f'Pyarrow took {end_arrow - start_arrow} seconds which means {per_q} second per q')



