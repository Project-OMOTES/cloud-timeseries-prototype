asset_ids = ['0201ce34-cb70-4728-be09-e9748de64d6f',
'020c352a-3d35-4b2f-9150-2387fa82e27b',
'02ccff7b-4713-4502-a7d5-5561cef5246f',
'0301d946-166b-406e-a3ee-9ebe50f8da22',
'0330bd32-36d0-4ea4-bbd0-d2c81907d910',
'04d37b4b-5761-4f85-8754-796e337b5d57',
'067cc051-a494-4ec8-a9fb-c85d081f9cd8',
'0692f115-773a-4b71-a11b-5f58cd92156c',
'07620812-22a9-4786-8c97-4c635478c8a4',
'0826b1c4-288b-4c63-afd6-41fd3605f05b',
'0973c883-0ac0-4d78-b65c-b6d2ceed5d9b',
'09feca31-3a7b-4e02-87d8-2f2f32233464',
'0c86e2d4-e53a-4534-ad33-20ba530925a1',
'0c896f87-1969-48cd-8920-266cd44f3c43',
'0ce6d9f2-f9d0-4cbb-9e6c-ada598588e6b',
'0d312d47-42a9-4aa4-9390-03a5312dbdcb',
'0d61f567-4082-4376-bbb7-ee02d78885e3',
'0e56849c-fb1f-4879-a512-e41db5c439bf',
'0f718fb7-4e27-4d31-bc0f-78abc7e9b844',
'101b59fe-e1e4-4f7a-a35b-acc997a964a5',
'10c6467d-1834-4cbf-a34a-d065b3d7c213',
'1284ea34-0aa7-499e-a458-baaf79bd7bdb',
'137df02d-48a3-45ae-954d-389159dbd57a',
'13d474e6-7f16-4649-aaed-afc6fb84d360',
'1428ec4a-bdfa-4dc7-9f16-5d496076d2d8',
'14355b50-867f-4504-b187-68a56abbc68c',
'14bd333b-c99f-4156-b3d0-ff2a184f86ed',
'18b56ec7-b702-4188-a5ff-f2a8e3f8ec04',
'19c6147c-a1d2-4020-815b-e2d6277f463c',
'1ab625f0-b132-444d-b6ba-f5ec701a21b6',
'1b4bbba3-f032-4a79-8c97-09c76a8a2607',
'1bc54eb9-6dae-47db-91de-5370877b6bf4',
'1bcf1044-b68c-4a4e-a3e6-8e2f32e389d5',
'1c68c67a-55f9-430b-bc5f-53db8cd885dd',
'1d69002e-b061-4b4d-b003-a1e1ca826bb9',
'1e4eda8f-a06a-4056-8d97-f79c8515df9a',
'1f452ffd-05e4-42cf-9b66-9a2d9bf19b73',
'21aa8793-93cf-43cd-a753-b8e5a1b41f77',
'2571fc29-c49b-4072-bf70-72250386857a',
'279564f8-4812-4458-88d9-90fd3e91751e',
'280600b2-5fd6-49cb-a09b-3b2d247fb4cf',
'285d17c4-db90-4322-89dd-c86b139148f8',
'298e46b2-8287-4ac8-b003-2e7e1c87b6a0',
'2b52df81-eaee-42de-b876-916193e4ae43',
'2be1c5f5-9b5e-4c4b-b1c0-9d2fd2214195',
'2eee4013-85f3-4b6d-8906-ac30ca576896',
'2fadf62b-0f9c-472a-9549-7e775705532d',
'2fc0a688-75ea-4841-9d51-dd5050567eb3',
'3099b166-fbea-47d6-b0a7-4e9a16178f86',
'3119f7e8-6711-4007-a208-d2403a332c37',
'31f66447-1ab4-473b-82bf-2eddf9e1e9b6',
'327f913b-0253-4ba9-838f-fdcb68d8d98a',
'3583f4d4-4b99-4a9f-916c-14e4eb491083',
'3608afe0-42bb-4d7c-ab1e-6bb88997b456',
'36dae341-f8cd-4b4e-a503-8b2983967e00',
'379f126b-f33e-4dd1-b1ec-1c6375359ec4',
'38041c32-5053-451e-bb6e-0c7e784658a3',
'387acfef-b279-4014-8409-88e58a84a9ea',
'3912e6c2-fa09-4e42-8759-9a777d743885',
'39fdb989-d6ad-48ca-bde2-40cf2d45d1a6',
'3ab5730d-1d80-4fd0-bfd4-0e65f6559d09',
'3d96376a-47cb-4fc3-987f-b70817eaab5c',
'3f5b27a8-4f29-4006-a90f-5e47823dd377',
'42b3b855-7393-4cde-9ad5-1c15065e5c5d',
'43285246-ebea-4674-95f2-024e975c4cfc',
'44040115-2fbd-43d8-b6df-ed10b2e24356',
'44274ceb-befc-41c4-b510-45ddd47ee1f7',
'456d3d62-efe9-4d22-985e-544a300bdc50',
'4630eb91-1e3a-466d-8856-89dfab75330f',
'46dffd8f-170b-4469-8e0f-1bc5b3ad0167',
'47215ffc-ab96-4850-8a80-215ee8533478',
'48c446e2-64c7-4e1f-b4af-acc1d6780aff',
'49c6e03a-6720-4bf1-8a5e-d22c159fcd6a',
'49f3e26a-fc78-4fee-b0ea-ca9ae179af6a',
'4b20cd55-9f5c-4f0a-8a96-2c2fdb1d5cc8',
'4b2fd6dc-8596-422a-bb51-5179f788db26',
'4bacf0e7-a50c-41a4-bcbb-f2914a16c991',
'4bb48c2f-02a1-43a7-860f-8cc235588dc2',
'4f8cfbed-c07f-4282-88c2-2127f7f2ee8b',
'508e1480-3cb3-4b23-bdbc-b734749cb40f',
'50a21f7b-3917-4842-9390-e8720960c475',
'5187bd9e-f157-4cb3-adb2-9fb0a7b40063',
'5212c81b-5949-4b8d-9431-c1414b12547a',
'5280e4c2-4cd1-4876-8b55-149c69f0771a',
'533aba5c-6341-4e7e-8efe-8aecf4915fc6',
'54c4a078-b16b-4d89-a00c-0350e2d9de2a',
'57aa58a5-92e7-4d61-a762-10e29d8ecd24',
'57d7d730-1248-4666-9a3a-2e3815fd25e3',
'5aa4c3ce-bb4d-489f-b1bc-20eb27ce991c',
'5b198c4d-c57f-4d33-aab1-50e31934f3ea',
'5b290f79-f35e-42ed-9f1b-e46232c695e0',
'5bbb6615-52a4-4aa8-a26c-1617433fb27e',
'5ca6f803-7bbb-4ccd-86dc-d8462d73f445',
'5cd153fd-76b7-4b2a-8fd5-3615a3746f38',
'5cdc8526-6109-4307-93f4-16f182419291',
'5d5d3cd3-f1c3-461c-abf0-0570a2e4a912',
'5e269b16-ecd3-4a05-bba8-4a9d3ef53cb2',
'5e4ce256-14e4-45af-acb4-d20176ca5e6f',
'5e814d05-90c9-4f8c-ae23-c3d61026a819',
'60d25f86-171e-4c52-9c5a-6091df9804ea',
'624cdde9-81f9-486f-bc13-da1b876c23d8',
'630e93eb-628f-4f4a-98c8-2bfdb11cb97f',
'63237442-ebcd-4e2d-8ba0-f9cdf1d489bb',
'64b93c80-72e9-4ad3-b88b-94791c252872',
'654f3db4-7241-4a70-bc99-e709a799b4a0',
'6af7bd3a-84af-4345-8873-3a4424d9c775',
'6b7408d9-0360-497f-8fa0-d5da17f4f50a',
'6dba1d23-a19f-4d80-a29a-2c9e29d5c18b',
'6ec11d5c-6306-4eca-b1c6-32820b83f2ea',
'6ee732b7-1f06-45f3-add7-e4c1162a2f34',
'6f572a47-b04b-4b10-84b5-1ba85f33dcf2',
'703c7530-2f98-459f-b859-d9ad30cfd2b9',
'73b36af2-d37b-4daa-94d3-20709599751d',
'73b9cc98-8eb1-4e39-919e-db5f4a254c1e',
'742bfd46-57cb-4c60-8be0-ccc4bd64c1fc',
'7526e863-7f4e-45fc-a800-31c47e362d26',
'76f3728d-58e3-4c8d-8a52-580e87bcfa59',
'77af2970-5733-482a-88af-4f11ab1b8f53',
'78ca0aa5-a564-42f2-8088-9490c245014d',
'79ad76eb-6539-42ab-8ae4-2b78affb54cd',
'79bc8921-9ee9-4571-a794-9da332f9688f',
'7ec74d44-a014-45b8-bc8d-1a22623a8e86',
'7f6a5362-9d95-4b64-9516-f5e35d4dcdbf',
'82008115-575e-4542-8b76-518e611d8fe1',
'835a32c4-4dfa-422d-b3a3-98c9f9c53853',
'841c0c33-84bd-4c50-8eb3-59196ae098d8',
'85904f78-47c0-42f7-a8c5-d09c6be11ae0',
'864ec78d-b4b1-404c-8c44-3dc86d66d60b',
'8892c13e-e87f-446d-abf9-281729e593ab',
'88ae8613-d530-4e0a-8fef-bd36d741a93d',
'88d61166-ac6d-4b05-a793-698553288bbc',
'8bd7d616-2666-46d4-ad6e-b99d6b440ef3',
'8cb2d285-449d-41a0-9dde-d4fe91af0442',
'8cc86847-83f0-4a61-a5f0-e51e42e06410',
'8e439f0f-1d59-48f3-aed9-05d302bbf923',
'8e84eed1-3b85-4fb1-a9eb-7cabf4e09422',
'8ef189ad-020f-4ef4-88b2-932ec21e8f5e',
'8f444024-f2a3-4ec9-a780-60bde88b31c4',
'8f78ebad-4a65-4f68-a5b7-72798ef11026',
'90aa4bc3-d23a-4648-bbd0-ef77129487ca',
'9100e3ba-7998-4f90-91f6-8acd17e41418',
'9124e3ba-d59e-4bed-9902-2a95b3d0e4ff',
'917ff3a7-43be-43ef-949e-47d7c58d43c0',
'9292539b-6dad-4584-806d-49bd2c1c8ab1',
'934945c7-0c0e-4b52-9ad9-7043ee8de922',
'934e2108-4db2-441b-a7bf-6d41a818870c',
'940b679e-73f7-4191-b7d6-043f862b3e53',
'94750c88-149f-4b3c-b4cb-67632e1a23a0',
'9579d53c-969d-468c-9f4d-290f13c5a79c',
'968e7a2c-b9ea-4c7e-8fb5-37bf0f1f61b6',
'976dfaae-7238-4cdd-aeca-304a759d1cde',
'979666fc-dd27-4d58-a058-d403853e1982',
'97c7e2f3-57c5-430d-93ab-1f59f56a736d',
'98d6ea89-5002-441f-841e-618f26d7fdb7',
'99a37e69-b124-48e8-9b5b-4296631260c3',
'9a41e94b-5f49-4b47-a703-bd20e7469029',
'9c2b1afd-4b6f-494f-8e5a-08bc2bddff74',
'9d1af260-4a4e-4224-a8b5-81c4c74fb4f1',
'9df02068-efc2-447e-88e8-db6b846f4088',
'9e697651-e430-41e9-b4e0-856b372cf1e9',
'9ef2a43b-7426-45af-aeec-5bc48094e693',
'a1790e39-9370-43de-9f18-d4a07162cc3e',
'a30e8ac9-5591-4ec3-93b0-17a3dc086699',
'a3bbadf2-3acc-4ee3-8fbd-4d9d6573c0a1',
'a4123a0f-b6e5-467a-8707-8a0c5d5264a2',
'a4485a66-7003-4a47-a4c2-5a0a42d83cf5',
'a48c897f-b980-49dc-92f8-a2907b1950b6',
'a4d55625-8248-42b7-b042-4f959a16d3df',
'a66bc6b9-e984-42a7-a83e-87ff349cf0f4',
'a68a3a14-0b33-47cc-aa3a-cd9e30392e96',
'a6d06716-0bae-4db3-b12f-f01ab1a13a31',
'a6d91e12-4fb2-49e5-ae09-7055dacc661b',
'ab2d9f79-5e05-47e7-a0bc-b261535f024b',
'ac7fd783-cf54-4845-a33f-5dcbdafdb526',
'ac96f252-d9aa-4fa6-a3d9-9cfa45a7f621',
'aefbd7d4-7e55-4950-a613-cfd8c00628eb',
'afedf5fb-6e78-4424-ba20-24bac3205886',
'affbc6bf-9485-4ff8-9cef-b956bf7cde82',
'b0f1f9b0-d418-48be-893e-a2f385d5ca54',
'b2a0e0f1-2683-4212-a0e7-6fbe571001ad',
'b2bad957-0faa-4db0-b0e1-f9428081a639',
'b31f19cc-91d3-4807-82c7-6c5141e2db0f',
'b45cdb23-9651-460d-a407-07098d579b03',
'b68b5d61-e18e-4bcf-a7df-66e24c361d1c',
'b72d97c2-a277-4a26-afcc-9ecd7cd7d0ce',
'b78be47f-f9b1-4574-81cd-033c2b007b46',
'b97f3248-dc14-4b09-b7e9-965fdfef5db7',
'b9a2ad22-e06b-4d20-b1f0-87ea8e0bf909',
'c12f0b4b-dbb3-45ef-bc99-61d82654e278',
'c25bf7d6-599c-45a7-839d-010864a62385',
'c2789f26-3e4f-4322-8f06-dc6c1ee7ecb5',
'c34c1be5-a825-4d75-b076-173d59fe375e',
'c393f2f1-ace1-455b-99e7-22ced828f070',
'c4904c84-461c-4769-8648-45b0c6be0e4f',
'c5811970-7ba0-4e11-b30a-037bcd6a73a1',
'c6d829ee-5fb6-41cd-938b-cdf5c0cb70f5',
'c7c931df-d0f2-491c-b003-5805a1538aef',
'c978c4df-300d-4f0d-94fd-fb8db183234d',
'c9dcbf8b-b4f1-4725-983f-df01c3da3bc8',
'ca569dcd-ad16-482e-b772-666d650d991f',
'cbbd776f-f48a-4f1a-8bab-566da000021e',
'cfeec40c-af14-4df9-9e15-1bc27297745d',
'd0349351-f28f-4648-aa15-c12c86c3e114',
'd184bfd5-69d0-4086-ac29-5cb5e9399d1f',
'd1c61a2d-4b8f-4850-8501-32a8ee0cde62',
'd3333dc4-f691-4698-a906-6f5cf08694a8',
'd39e4cb9-e86f-4a5c-a393-ba2694580a6d',
'd49534e7-7770-4f6d-aaf9-ce9276424d8d',
'd4f75c14-40aa-474f-8f8d-d2253fa436d0',
'd50ee31a-7beb-4b62-ad49-dc09a32a3c2d',
'd5d39fd6-1918-4b0d-8e35-b5a883f0572b',
'd6ca02fb-1402-4948-a3d5-72db83188266',
'd6f449dc-c443-4636-ae89-ac0762446818',
'd718637b-7ecf-41c7-9eed-dd1422f9c75b',
'd97e4791-9123-43e5-9c3f-a16cbc873662',
'd998b483-059f-4fe5-8dac-aa92ab339b35',
'd99ed4eb-f08f-4472-8db8-f638644dd77e',
'da145bec-7d2f-40e3-9038-5392f31b9f34',
'db268849-bc1f-4993-8934-41a1d4b56102',
'dbab866d-a4a0-48b9-bd4b-d742602d2a49',
'dca70bd5-e9a2-4f9d-ad97-94f3a0b03923',
'de382a95-ede3-4c14-8995-f87ad5ea29f5',
'df00db77-b8fe-4e6c-924d-091c1e964f26',
'e196b6df-e145-4562-9d43-eb29bd914341',
'e22b567a-11b0-4c6c-bd7f-7245f637337e',
'e2e45fc5-dde5-4a96-90e8-b5284df37fe2',
'e356dc73-543d-4bc6-ab28-9607f6506721',
'e80d23cf-1a98-482e-8639-db3ffbd714cf',
'e910b71d-c830-4d01-92cf-9dea870fb114',
'e9ecab4a-c4cc-444a-9ca6-33377c71b564',
'ea663435-a2ed-4d69-85ac-f15af6702b83',
'ea7826c5-a5c7-4657-a904-7d920a61d733',
'eca3a237-c046-49b7-b532-f1b868466b40',
'ed4cfcae-6cf5-4481-a845-2fec82a9c4a5',
'ed8f5b20-da0e-4121-9e69-d23aeaac790d',
'ef3e6067-c852-41ba-abe6-9b40f9175fa5',
'eff892af-73ae-49f7-bc52-c07313a57d54',
'f26ee2d6-c769-4f79-999b-b43d17366c0c',
'f28798fd-6b41-460a-8ade-8067a1405008',
'f497b73e-65c3-4344-9199-0c415f39bbd8',
'f591e4d4-3aa9-4590-b8f0-e5104c19ba54',
'f8aa25c2-f504-40a9-a148-1d2caf8458c0',
'fb523988-b75e-40fb-913c-451f39ca17c8',
'fbbae02d-3f67-474a-9e08-aeb89330809f',
'fd2a87de-ba00-4675-a782-496e5d947cc4',
'fdcc9f15-e984-46c8-b35a-4adbdba86026',
'febf2f13-991c-4c8e-924f-d0431919d9f8',
'fedd279e-617d-4724-98af-4aafed359e1c',
'feef4c70-0a72-4c87-bba7-7207d832615f',
'ff8a020c-c852-443e-ba07-b62277561544',
]

import time
import pandas
import duckdb
import pytz
start_init = time.time()
con = duckdb.connect(":memory:")
con.sql("""
CREATE SECRET secret1 (
    TYPE S3,
    PROVIDER CREDENTIAL_CHAIN,
    CHAIN 'env;config',
    REGION 'XX-XXXX-X       ',
    ENDPOINT 'localhost:9000',
    URL_STYLE 'path',
    USE_SSL false,
    KEY_ID 'test',
    SECRET '12345678'
);
""")

start = time.time()
#for asset_id in asset_ids:
print(con.sql(f'SELECT HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/8357896d-dd72-43bb-814c-ed7728ea122b_*.parquet\']);').df())
end = time.time()

diff = end - start
per_q = diff / len(asset_ids)
print(f'DuckDB Took {diff} seconds (with init {end - start_init} which means {per_q} second per q')

#
# from pyarrow import fs
# import pyarrow.parquet as pq
#
# s3 = fs.S3FileSystem(access_key='test',
#                      secret_key='12345678',
#                      scheme='http',
#                      endpoint_override='localhost:9000')
#
# start_arrow = time.time()
# for asset_id in asset_ids:
#     len(pq.read_table(f"test-parquet/8357896d-dd72-43bb-814c-ed7728ea122b_{asset_id}.parquet", filesystem=s3, columns=['HeatIn_Q1']).to_pandas())
# end_arrow = time.time()
#
# diff = end_arrow - start_arrow
# per_q = diff / len(asset_ids)
# print(f'Pyarrow took {end_arrow - start_arrow} seconds which means {per_q} second per q')
#

