asset_ids = [
'02f75d16-d840-4f8e-8f47-09d298711e1e',
'0485e823-b4e5-4a7f-88fb-e42f36afca6f',
'05a7dfaf-e429-4fd8-93fd-ebc031e4f84f',
'063cc768-7e55-49ca-814a-ecb2e4862bd6',
'07729321-54d0-4099-a9eb-93e2d977ddc6',
'08365cf3-1ac8-4d63-b73c-2c39e20eb0b7',
'08ebbd35-bfee-47cc-adbf-c17a8f007113',
'0a098118-ca01-414d-b964-c6fa6c2e7cd1',
'0a4b054e-e6f4-43ee-85dd-134c6b25ef8c',
'0b0da402-3d90-4090-95b9-535f32d4d001',
'0ce74cde-b60f-4e0c-8764-4766fb9825f7',
'10e14b61-96f0-4bf3-80a0-7899df16bed5',
'10ebc951-bf42-44e3-a394-9e7cc0da9c47',
'1236b14c-8cbc-4767-9849-befa98e2718c',
'13060e78-8e5d-43dd-9c78-11122ebb6242',
'1433a976-4c18-4ce2-9820-375b58981b1e',
'153b589f-5db7-48b1-a590-b69322541a47',
'174cc624-8990-4320-a15e-1e27890b241d',
'18224367-44ad-4251-83d0-da03954f14c7',
'18a01830-d2aa-4d6e-b5d3-3f3e03bb8c23',
'18cf7674-f6fe-4982-be93-5a5e0ec2ad8f',
'18eb50c9-a184-4f36-b3e3-4230f0549eeb',
'1b7acb2f-2877-4a66-895d-70c3a7c8fccf',
'1c2ae0b8-8216-4f77-9579-c35104a43ac2',
'1c989eae-1bb8-4fb2-a1d2-07a3bcdc74e2',
'1e7fb4c8-9abe-4b00-98f5-d0e46d43c0ef',
'1ed54f66-9560-444c-aac1-a153691334f0',
'1fb8765e-164c-46b1-b7ad-00b4066fbebb',
'2133743e-00e0-4bce-a932-41cf74774e69',
'21e2b6fb-fcf5-4df4-9a15-ac7b8fdd6b14',
'2317d337-e457-44e4-8cf3-b5c48f032db0',
'23b804fe-5f50-4cf8-ae69-69b12eabd4c8',
'25fce21c-1d5b-45d9-af78-ea1ba151f679',
'273fffc5-f0b9-4cbf-aac4-8bf172e75e63',
'277bb433-6182-41ff-8362-68bd1b6a3613',
'280cfd67-1492-4ca5-af27-0969720e2f65',
'297d0e93-d719-42a5-8f8c-d8d909d05d0c',
'2b19eb42-fedd-4751-bba0-462f82c5d8dc',
'2c0937f1-d56f-4da7-ab73-e865c5976ffa',
'2c0f831e-8612-471e-8bcc-aa2b53a3f25c',
'2c2017c9-d1ad-43dc-8606-85e190279d82',
'2c78fa49-5f6e-452f-91f8-9028c21daf01',
'2e60831a-b71e-4158-adf6-ced5fcc537e2',
'2f7d326d-5d70-4d65-83c3-9acc19ed9c04',
'31384981-6d06-45d6-b70a-3ade5b1d8af8',
'313f71d3-23e7-4469-bdda-db037544784d',
'31e9b082-ff9f-4302-9c0c-6e1bea1d6b55',
'31ea683e-f68c-4f2a-9c66-f484ce0c19ca',
'32f6c040-c7c1-4760-8f75-edbe8dc71db0',
'3390dbec-3fe5-4d9e-86bd-5713bb9711bd',
'34171fbf-66a3-4b87-a6fd-8fdb9cb408c7',
'3494feae-b7c8-4040-b717-2fd8e6eaec22',
'34cc583b-4f09-45dc-b28a-3e734f9030cd',
'35755199-d5e8-4c7e-aada-a798eb335cb7',
'35b72ed7-283d-4e3e-a6aa-5fff7382e23c',
'36af591e-da75-4e49-8e60-3131632d22d8',
'36ec8d32-2a5b-4ab8-92ed-70cf90f2d6af',
'3797ff91-0a7f-4d89-a56d-1e40d2c12dc3',
'397c6151-f8ae-4b2b-98bd-bbd752befbbb',
'3a46877d-b329-42ed-93be-7a0be1e37319',
'3aaba43b-5350-4f9a-89f9-e332bd214955',
'3aae0335-644e-4937-a912-18857604b631',
'3b367516-3db8-49dc-b0ac-6c69f4764b9e',
'3b97ba7f-1ddb-4750-b914-c4dbec86234e',
'3e23faf7-00c1-4a37-b33f-a3ab51c780a7',
'3f00bf5d-d3e4-49c2-b2db-293b86c35260',
'3f15631a-0a8e-488f-b856-e643378d35a1',
'402ee185-d88e-4def-ada0-e8022d5d22d4',
'4048cf8e-d552-471e-85da-a078239676aa',
'40c3834a-9ba1-4c12-83d6-9d456e31170a',
'40d6f00e-8709-4e24-b355-fb2003798f4e',
'4269fde9-d803-49a4-a7d6-82022b302f1f',
'42f7f9c1-07ac-4860-b8ea-6c6efb13373e',
'43651d57-ebe6-4108-971d-baf07f452ef9',
'448e2522-c74c-4cd0-8f59-ce6e49f91eb3',
'46ba0d8d-d398-4aeb-9698-ece43a54e5b7',
'47bd2557-2900-4ff4-bdce-1407aa1a52d8',
'49f333fa-941a-4afc-bb95-1895a78a6157',
'4a0a0d5a-e51c-4fcd-810c-572e742a9e23',
'4ae343b6-036f-47ee-b8b7-ec1ed744346c',
'4cae40b0-e756-40c1-8d9e-0d7f95bb3d1c',
'4cf8f9df-ab89-44f1-a7df-cf9985b8f4e7',
'4dadc112-d330-4ca5-bc94-126a3c24b56b',
'4e7bf93b-633f-4938-b007-69f8d253291a',
'4f67baeb-d624-4753-b856-ccb76742b9bf',
'52aa069a-c128-4f39-a891-dc6d9fa6a62e',
'52e31617-fba5-42b6-8c4d-551a83fd1c18',
'5756822a-af9e-4d74-83bc-03b6c82a4d6c',
'57f26c2f-af47-4d42-8df7-50622f2a4e56',
'59ec8cbb-b3e2-4e57-b4e1-ad813abd3a52',
'5a7ceafb-cfcd-4109-abcc-a971271ecaf1',
'5d47ac5a-e264-4927-beea-8bf9935422fc',
'610f8a66-d902-4e79-a87b-43ce977ff953',
'629def48-91fa-4b79-9713-fe7ae74bf59d',
'64049c54-7cee-4a92-a195-2e2f22b2c9b6',
'64494fa4-1544-4045-ac1e-d423b0bbeab6',
'64c81ddb-0fd6-47bf-be0a-be380ac8c9f4',
'65b59c4a-0126-43c0-8002-48ad8f2c395b',
'6a693ac8-90c7-40ce-b985-9bd2d620fa92',
'6ae29ec7-23fb-4025-9997-d4d47b640eef',
'6b180805-89d8-492f-b747-60b5980e421c',
'6bd80b62-25cb-4797-940d-7b55959073de',
'6f3b74c6-62ee-49f9-b84c-bd24055d39dd',
'6fa4da3d-52e0-44ec-8d41-be09957fb120',
'7028b09a-b115-4ba7-b247-170d7f1ae56e',
'70e42b4a-3ae8-4583-83e6-aaac13b2a1ea',
'714f07a3-e989-4a12-a7d6-ea8a9b57f28d',
'72704bcd-4fa2-4fda-96b1-c723d5874f7c',
'727b75a4-739c-4d00-98b4-9eba1003e7be',
'72e34c4a-8f71-4ad6-9c4a-05aab0e842a2',
'7321523d-f60b-4a55-ad6d-d23ae0f457ae',
'7383f552-ddb3-4416-a112-7d529889dbb2',
'740e4ae0-31dc-4523-be55-7ff3ca0d23ab',
'743de131-fd8a-4798-b356-e78a1213d29d',
'76e0c92d-6dcc-47d3-bab8-69bdc44dd649',
'77bece92-d531-4a4a-b4ec-d5da2d99cbda',
'77cf3618-07c1-46c2-81e8-032edeb5754e',
'79b10c81-4885-4a2b-8a51-0383e5f940a2',
'79bc5fb7-58a3-45a1-857b-b870359c2c8d',
'7a88f533-4392-4cfd-bbe8-4a2e22db5573',
'7ca9ba42-7367-4c0b-bcd3-19e781a4ec70',
'7da94c32-989b-454d-9134-dcf2d7ef75d2',
'7eba670e-f42e-4090-b3c6-b431c787d701',
'7f4b2003-dc5c-4c2e-a636-61e20ccde8cf',
'80646a1d-4dba-43b1-b527-25d1dbcbe2d7',
'80e0fab8-66f8-4874-9606-623b3eec8afb',
'825f382e-e065-457e-842e-01ff03b4b284',
'8286cc53-3f2a-41df-898e-1eabeed26720',
'845bdadc-4768-4f54-bcad-371b6caa0e82',
'880ba8cd-8875-4418-aa5e-be3051917f2e',
'897cde44-51e7-4e19-8f0d-8f5978b3eef5',
'8aa2887d-1c92-483c-9c74-e99b9b51e7d9',
'8ae719e3-bcbe-4e2c-b9ad-192094b26246',
'8c769c95-c13b-4a52-bbff-4dc64a9fcac0',
'8cf41808-53ea-4d9c-9852-45f0f574b650',
'8cf956fb-8ead-488b-9947-c4dcd25af46c',
'8deeb300-03cd-4f52-924b-4ba4aba8599f',
'8e43ff49-e332-47e4-9a45-c1e96b243fc1',
'919dc8e4-f358-49a3-9671-353e1a9a6b95',
'9380f119-c748-4790-bbf4-18dbbb7c56eb',
'93f319c1-691b-4126-854e-5dd073c83edb',
'9420b740-688e-4a4f-a7b7-540eebb5d23e',
'94557b82-a811-4616-a491-f55b14c35b11',
'95131f4a-7de2-4378-a137-c63874830c66',
'95eab690-15c1-47de-8785-bf4d980a87e6',
'98436c8c-75d9-4c74-8962-c1f587bd5810',
'98694246-478a-4d54-9f1d-2159771f918c',
'98e238eb-9589-40d1-9293-c62d9eba4eb4',
'98e5f154-8824-45a8-9dcc-c6974195bae2',
'98e858dd-58e2-494b-bd15-bcc5813b2133',
'999ce16c-4db5-466b-b4b9-9a2beec9aedc',
'9be9e762-64de-48f1-956a-ee956e77764b',
'9c935095-e3cd-4914-8700-8eac8184dd92',
'9ce76654-6555-479a-98a5-976906285d2f',
'9e9f2983-6610-4249-aeca-6a9d54d38ad3',
'9f4f72d8-fee2-4196-91de-cc670bdd5ebd',
'a0a1634f-32f8-4b97-9128-4be8aecabf35',
'a140e523-7135-41df-9653-66708fe0f3a8',
'a24c8574-7414-449a-be9c-e6f0399266b6',
'a2ff83b7-be63-42f9-90d2-9591ce47cd30',
'a4925c63-16d1-4d51-94ed-9d02a35ae2c2',
'a57197a9-2a05-4b76-8aa8-ec2b2e21c476',
'a7418e2e-3f39-4b84-9afd-6e7f3a9d0842',
'a85ef2e1-375b-421d-b66e-626fb0f8c302',
'a959fe7b-6b98-45a7-af94-a5e57a7434d4',
'aa47178d-9406-416a-b80b-366e1d6f662d',
'acdb043a-75d9-4777-84cf-e573066d2d91',
'af6b1234-d542-4df7-b2f8-d1fcc453bb3d',
'b0eed91f-c510-4463-88b2-2844ad58048a',
'b423a0a2-db70-40e0-bb7b-19e82e375b62',
'b4640691-4ec0-4bbe-9390-f975407669ab',
'b5c0c1a6-ad0f-45fa-a5dc-fd3203ee0ebb',
'b690b5ce-6dfc-4ecd-97af-8838f948117a',
'b74243ac-5ad6-4b1d-869f-482d7728248b',
'b759f9f5-e9b1-424e-93c2-ef1579dcf448',
'b7e7f626-435f-437c-a8ce-86ebf60926c7',
'b87df7e2-5424-4540-95c7-85800794f6f1',
'b9aa76bb-a593-4c38-8fad-d7a4a9bb1ce8',
'b9b4ca10-06c5-45d1-88db-6b7cf3170b23',
'ba1ac14c-77be-4c8f-9947-d25dbd61ba5a',
'bb94427b-9721-4036-91e7-580792bd12a4',
'bbd1db46-3f19-4e23-8fdf-75eee57d2041',
'be88a8d9-c6d0-4960-bc06-1d1f73ad74e9',
'bf5f81c0-e82d-4801-9a5f-0e47d7ca4665',
'c03f288e-b5fb-4ef2-8279-a87a745281a3',
'c055edc6-e2a4-4b1b-8d5d-73d28bbe0f62',
'c0f41412-b0ac-430a-a14c-bdde8ed08910',
'c0f85428-c363-40b4-ad55-9047e7d9dedb',
'c14a7bb0-f4c4-460c-9ae0-687c130b0166',
'c1c08e2b-0a7a-4a5a-93e5-bde386f3ffb3',
'c2f02942-2df2-4f9a-ade4-cf320903370d',
'c3248b1e-2fdf-4ccb-b1ee-27e4331ad89c',
'c75430ac-7a14-445f-801c-6119d4ab5ba8',
'c84335ee-f253-4760-9a04-f7fed029dfcb',
'c8eeff9c-5e88-41d5-9be4-a5f1307ed46b',
'c9b5c0d9-ef11-4d62-944d-cb9aa1df8236',
'c9dc5b77-f836-480d-8f82-e37d0a2fcd95',
'cb67ceaa-6aed-4912-b6db-a473d69340c7',
'cec3497f-f1c1-454b-b772-db978c167436',
'cf0facdb-6a27-44df-abd3-828917577ee9',
'cfa75cad-7ea5-4ebe-b9a5-c415d269b757',
'd1a0d90c-2a2e-436a-91a9-4a0b06858963',
'd3681cc9-1dbb-489a-ae5c-26ea5529bca3',
'd3aa9385-958b-4a63-a6e5-d6f251534222',
'd5b3ce98-b668-47fa-bb36-b8d44e6c14fe',
'd6546ec2-b009-40ec-9a5a-09cbc37ae29d',
'd78bae9e-d3d2-4f46-a067-01a7fdfb971c',
'd7a76a57-9a54-4c85-a516-5af983413dc4',
'd7ca9369-764c-42cd-9e82-5b4c972eff81',
'd856b022-36e5-43bc-a5aa-d7538f1ab348',
'd963be49-9a9d-4c94-afa9-def7dc7f9e80',
'da4b54ab-f24b-4973-ae73-9c8d731f107d',
'da8b1f2a-1290-4c05-a931-d210ac52fdff',
'dac40bcd-2441-454c-8de7-5aeb7be03226',
'db3dfb3c-93aa-47db-ab88-bedad8d6a123',
'db623cc7-86ae-42ba-a257-c4734a8f41cd',
'dbfe6c78-cfe3-45d3-95e8-eebe51ff6f77',
'ddbf4f32-6af9-43d1-855e-82f36c30cfc7',
'ddda8950-de9c-404b-b4f6-7c820b67c1db',
'df25109b-b2a2-46de-a0ba-88739356f91a',
'dff7d942-6335-4cdd-ab2a-d22185b0f3b3',
'e04356a7-e7e5-4ef8-8cbe-c7b699121a45',
'e0899c13-f795-471e-a363-8193d6844c02',
'e0adbfbd-51e3-4997-b4b6-3c44a52e25ee',
'e19b9015-f8cb-4066-a27e-613737fee192',
'e295be8a-2be7-440d-bddd-a61c4214a60b',
'e3a8fa70-34d5-4ea4-965a-a29f04816100',
'e4fd3827-d071-4d7d-b06e-849762700b78',
'e5f06aff-d055-4c6b-8823-b63bf7dd9254',
'e68e6165-f22c-4f28-90e7-de76fa82d0ff',
'e766e0fc-4bfa-4655-99a7-d7c3911f18c7',
'e9b4f24d-f508-4244-a344-9226c6ad5412',
'ea5c6042-e082-4359-b70a-a683abab4489',
'eb01bb4a-b421-4ad6-a902-3a88affbb2b5',
'ec1f833c-d29b-4ba7-a0d4-d9485c366e81',
'ed5e4998-baef-4d59-9dd8-1b1112488ac8',
'eead3ee0-4430-40a4-8e74-9208f06fbcc2',
'f336766f-b1a9-4ec2-813f-369d61760f90',
'f371dc03-b4c3-42d8-b972-e8915445e1ae',
'f660d764-698c-4091-a9d5-12ed518fc413',
'f6b29410-1692-461d-8f03-2207f0086d99',
'f88bd87c-986c-469c-b91f-fef28624ef2f',
'f9a0a3c8-52f4-4c4f-a95e-8fe028a96a20',
'f9aa5fa5-2af3-4e51-8593-7f1722393b24',
'f9c6d748-2c59-45be-9d27-cdf00e09cc99',
'fb58f79c-45de-4f50-9e74-a30190cfbd71',
'fc64db72-b68a-4b50-bf01-09b0fc939ecb',
'fda010cf-b803-4349-8d8b-d0454cc0d176',
'fdd1951a-f014-4f13-bd9a-f5b7ec6fc22f',
'ff63a396-e738-4942-9768-8c85686e981c',
]

carrier_ids = [
    '48950278-7545-4d20-867e-d05392a46aea',
    '61fb537d-6378-4438-9a2b-8e52b0f0f04f',
    '79ead452-9994-49a2-b726-cdf29d182a8e',
]

import time
import pandas
import duckdb
import pytz
start_init = time.time()
con = duckdb.connect(":memory:")
con.sql("""
CREATE SECRET secret1 (
    TYPE S3,
    PROVIDER CREDENTIAL_CHAIN,
    CHAIN 'env;config',
    REGION 'XX-XXXX-X       ',
    ENDPOINT 'localhost:9000',
    URL_STYLE 'path',
    USE_SSL false,
    KEY_ID 'test',
    SECRET '12345678'
);
""")

start = time.time()
for asset_id in asset_ids:
    for carrier_id in carrier_ids:
        con.sql(f'SELECT time, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/asset_id={asset_id}/carrier_id={carrier_id}/*.parquet\'])  ;').df()
end = time.time()

diff = end - start
per_q = diff / (len(asset_ids) * len(carrier_ids))
print(f'DuckDB took {diff} seconds which means {per_q} second per q when accessing a single KPI individually for a single carrier and asset')

start = time.time()
for asset_id in asset_ids:
    con.sql(f'SELECT time, carrier_id, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/asset_id={asset_id}/*/*.parquet\']);').df()
end = time.time()

diff = end - start
per_q = diff / len(asset_ids)
print(f'DuckDB took {diff} seconds which means {per_q} second per q when accessing each profile individually for all carriers')

start = time.time()
for carrier_id in carrier_ids:
    con.sql(f'SELECT time, asset_id, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/*/*/*.parquet\']) WHERE carrier_id=\'{carrier_id}\';').df()
end = time.time()

diff = end - start
per_q = diff / len(carrier_ids)
print(f'DuckDB took {diff} seconds which means {per_q} second per q when accessing each carrier individually for all assets using WHERE')

start = time.time()
for carrier_id in carrier_ids:
    con.sql(f'SELECT time, asset_id, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/*/carrier_id={carrier_id}/*.parquet\']);').df()
end = time.time()

diff = end - start
per_q = diff / len(carrier_ids)
print(f'DuckDB took {diff} seconds which means {per_q} second per q when accessing each carrier individually for all assets using partition key')



start = time.time()
con.sql(f'SELECT time, asset_id, carrier_id, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/*/*/*.parquet\']) WHERE asset_id IN ({','.join(f"'{asset_id}'" for asset_id in asset_ids)});').df()
end = time.time()

diff = end - start
print(f'DuckDB Took {diff} seconds when accessing the profile for all assets and all carriers at once')

start = time.time()
con.sql(f'SELECT time, asset_id, HeatIn_Q1 FROM read_parquet([\'s3://test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/*/*/*.parquet\']) WHERE carrier_id=\'{carrier_ids[0]}\' AND asset_id IN ({','.join(f"'{asset_id}'" for asset_id in asset_ids)});').df()
end = time.time()

diff = end - start
print(f'DuckDB Took {diff} seconds when accessing the profile for all assets at once for a single carrier')


import pyarrow as pa
import pyarrow.dataset
from pyarrow import fs
import pyarrow.parquet as pq

s3 = fs.S3FileSystem(access_key='test',
                     secret_key='12345678',
                     scheme='http',
                     endpoint_override='localhost:9000')
asset_carrier_partitioning = pa.dataset.partitioning(pa.schema([pa.field("asset_id", pa.large_string()), pa.field("carrier_id", pa.large_string())]), flavor='hive')
asset_partitioning = pa.dataset.partitioning(pa.schema([pa.field("asset_id", pa.large_string())]), flavor='hive')
carrier_partitioning = pa.dataset.partitioning(pa.schema([pa.field("carrier_id", pa.large_string())]), flavor='hive')

# print(pq.read_table(f"test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/asset_id=ff63a396-e738-4942-9768-8c85686e981c/carrier_id=48950278-7545-4d20-867e-d05392a46aea/00000000.parquet", filesystem=s3, partitioning=asset_carrier_partitioning))
# print('')
# print(pq.read_table(f"test-parquet/62a079a5-5aff-45cd-930c-eab253700375/asset_id=0072f6a9-f1ee-4df4-8784-99502509fb44/ef8a30d975bd44e9b0feeddbb513ea05-0.parquet", filesystem=s3, partitioning=asset_partitioning).to_pandas())

start_arrow = time.time()
pq.read_table(f"test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/", filesystem=s3, columns=['HeatIn_Q1', 'time', 'asset_id', 'carrier_id'], partitioning=asset_carrier_partitioning).to_pandas()
end_arrow = time.time()

diff = end_arrow - start_arrow
print(f'Pyarrow took {diff} seconds to retrieve one kpi for all assets and carriers')

start_arrow = time.time()
for asset_id in asset_ids:
    pa.parquet.read_table(f"test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/asset_id={asset_id}/", filesystem=s3, partitioning=carrier_partitioning, columns=['HeatIn_Q1', 'time', 'carrier_id']).to_pandas()
end_arrow = time.time()

diff = end_arrow - start_arrow
per_q = diff / len(asset_ids)
print(f'Pyarrow took {diff} seconds which means {per_q} second per q to retrieve one kpi for a single asset and all carriers')

start_arrow = time.time()
for carrier_id in carrier_ids:
    df = pa.parquet.read_table(f"test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/", filesystem=s3, partitioning=asset_carrier_partitioning, filters=[('asset_id', 'in', asset_ids), ('carrier_id', 'in', carrier_ids[:1])], columns=['HeatIn_Q1', 'time', 'asset_id', 'carrier_id']).to_pandas()
end_arrow = time.time()

diff = end_arrow - start_arrow
per_q = diff / len(carrier_ids)
print(f'Pyarrow took {diff} seconds which means {per_q} second per asset to retrieve one kpi for all assets and one carrier')


start_arrow = time.time()
for asset_id in asset_ids:
    pa.parquet.read_table(f"test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/", filesystem=s3, partitioning=asset_carrier_partitioning, filters=[('asset_id', '=', asset_id), ('carrier_id', '=', carrier_ids[0])], columns=['HeatIn_Q1', 'time']).to_pandas()
end_arrow = time.time()

diff = end_arrow - start_arrow
per_q = diff / (len(asset_ids))
print(f'Pyarrow took {diff} seconds which means {per_q} second per q to retrieve one kpi for one asset and one carrier using filters')

start_arrow = time.time()
for asset_id in asset_ids:
    pa.parquet.read_table(f"test-parquet/3f59be60-1597-46e0-9f1f-c5aa0a466a96/asset_id={asset_id}/carrier_id={carrier_ids[0]}", filesystem=s3, partitioning=asset_carrier_partitioning, columns=['HeatIn_Q1', 'time']).to_pandas()
end_arrow = time.time()

diff = end_arrow - start_arrow
per_q = diff / (len(asset_ids))
print(f'Pyarrow took {diff} seconds which means {per_q} second per q to retrieve one kpi for one asset and one carrier using prefix')
